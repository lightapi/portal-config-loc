(this["webpackJsonplogin-view"]=this["webpackJsonplogin-view"]||[]).push([[0],{76:function(e,t,a){e.exports=a(90)},81:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),c=a.n(o),i=a(36),l=(a(81),a(10)),s=a(68),u=a(12),m=a(136),d=a(131),p=a(129),f=a(134),g=a(132),h=a(135),b=a(29),v=a.n(b),E=a(39),w=a(130),O=a(124),j=a(126),y=a(127),S=a(121),_=a(128),C=a(35),k=Object(S.a)((function(e){return{error:{color:"#ff0000"}}}));var x=function(e){var t,a=k();return r.a.createElement("div",{className:a.error,dangerouslySetInnerHTML:(t=e.error,{__html:t})})},T=a(65);var N=function(e){var t=e.onSuccess,a=Object(T.useGoogleLogin)({onSuccess:t,onFailure:function(e){console.log("Login failed: res:",e),alert("Failed to login. Please ping this to support@lightapi.net")},clientId:"654131058807-15p8l5r4ddlusbeavvhiin9rt2cuglh6.apps.googleusercontent.com",accessType:"offline",responseType:"code"}).signIn;return r.a.createElement(C.GoogleLoginButton,{onClick:a})},P=a(66),W=a.n(P);var U=function(e){var t=e.onSuccess;return r.a.createElement(W.a,{appId:"603230757035427",autoLoad:!1,fields:"name,email",scope:"public_profile,email",callback:t,render:function(e){return r.a.createElement(C.FacebookLoginButton,{onClick:e.onClick})}})},D=Object(S.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},loginButtons:{width:"100%",marginTop:e.spacing(1)}}}));var L=function(){var e=D(),t=window.location.search,a=new URLSearchParams(t),o=Object(n.useState)(""),c=Object(u.a)(o,2),l=c[0],b=c[1],S=Object(n.useState)(""),C=Object(u.a)(S,2),k=C[0],T=C[1],P=Object(n.useState)(!1),W=Object(u.a)(P,2),L=W[0],R=W[1],I=Object(n.useState)(null==a.get("state")?"":a.get("state")),A=Object(u.a)(I,1)[0],F=Object(n.useState)(null==a.get("client_id")?"":a.get("client_id")),B=Object(u.a)(F,1)[0],q=Object(n.useState)(null==a.get("user_type")?"":a.get("user_type")),V=Object(u.a)(q,1)[0],H=Object(n.useState)(null==a.get("redirect_uri")?"":a.get("redirect_uri")),K=Object(u.a)(H,1)[0],J=Object(n.useState)(""),G=Object(u.a)(J,2),z=G[0],M=G[1],Y=Object(n.useState)(null),$=Object(u.a)(Y,2),Q=$[0],X=$[1],Z=Object(n.useState)(null),ee=Object(u.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(n.useState)([]),re=Object(u.a)(ne,2),oe=re[0],ce=re[1],ie=function(e){e.preventDefault(),window.location.href=Q};function le(){return console.log("scopes =",oe),r.a.createElement(O.a,{component:"nav","aria-label":"secondary mailbox folders"},oe.map((function(e,t){return r.a.createElement(j.a,{key:t,button:!0},r.a.createElement(y.a,{primary:e}))})))}return null!==Q?r.a.createElement(_.a,{component:"main",maxWidth:"xs"},r.a.createElement(p.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement("form",{className:e.form,noValidate:!0,onSubmit:ie},r.a.createElement(E.a,{component:"h1",variant:"h5"},"Consent"),"This application would like to access:",r.a.createElement(w.a,null),r.a.createElement(O.a,{component:"nav","aria-label":"secondary mailbox folders"},r.a.createElement(le,null)),r.a.createElement(w.a,null),r.a.createElement(d.a,{type:"submit",variant:"contained",onClick:function(e){e.preventDefault();var t=Q.split("/"),a=t[0]+"//"+t[2]+"/logout";fetch(a,{credentials:"include"}).then((function(e){if(!e.ok)throw Error(e.statusText);window.location.href=te})).catch((function(e){console.log("error=",e),M(e.toString())}))},className:e.submit},"Deny"),r.a.createElement(d.a,{type:"submit",variant:"contained",color:"primary",onClick:ie,className:e.submit},"Accept")))):r.a.createElement(_.a,{component:"main",maxWidth:"xs"},r.a.createElement(p.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement(m.a,{className:e.avatar},r.a.createElement(v.a,null)),r.a.createElement(E.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement(x,{error:z}),r.a.createElement("form",{className:e.form,noValidate:!0,onSubmit:function(e){e.preventDefault();var t={j_username:l,j_password:k,remember:L?"Y":"N",client_id:B};Object.assign(t,A&&{state:A},V&&{user_type:V},K&&{redirect_uri:K});var a=Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&"),n=Object(s.a)({"Content-Type":"application/x-www-form-urlencoded"},Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SAAS_URL&&{service_url:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SAAS_URL});fetch("/oauth2/code",{method:"POST",redirect:"follow",credentials:"include",headers:n,body:a}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){X(e.redirectUri),ae(e.denyUri),ce(e.scopes)})).catch((function(e){e.text().then((function(e){console.log("error=",e);var t={host:"lightapi.net",service:"user",action:"loginUser",version:"0.1.0",data:{email:l,password:k}},a="/portal/query?cmd="+encodeURIComponent(JSON.stringify(t));M('Login Failed! Click <a href="link">here</a> to identify root cause.'.replace("link",a))}))}))}},r.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"j_username",label:"Email",name:"j_username",value:l,autoComplete:"username",autoFocus:!0,onChange:function(e){b(e.target.value)}}),r.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"j_password",value:k,label:"Password",type:"password",id:"j_password",autoComplete:"password",onChange:function(e){T(e.target.value)}}),r.a.createElement(f.a,{name:"state",value:A,type:"hidden",id:"state"}),r.a.createElement(f.a,{name:"client_id",value:B,type:"hidden",id:"client_id"}),r.a.createElement(f.a,{name:"user_type",value:V,type:"hidden",id:"user_type"}),r.a.createElement(f.a,{name:"redirect_uri",value:K,type:"hidden",id:"redirect_uri"}),r.a.createElement(g.a,{control:r.a.createElement(h.a,{value:"remember",color:"primary"}),label:"Remember me",onChange:function(e){R(e.target.value)}}),r.a.createElement(d.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"Sign In")),r.a.createElement("div",null,"Forget your password? ",r.a.createElement(i.b,{to:"/forget"},"Reset Here")),r.a.createElement("div",{className:e.loginButtons},r.a.createElement(N,{onSuccess:function(e){console.log("Google Login Success: authorization code:",e.code),console.log("referrer: ",document.referrer);var t=document.referrer.split("/"),a=t[0]+"//"+t[2];console.log("host = ",a),fetch(a+"/google?code="+e.code,{redirect:"follow",credentials:"include"}).then((function(e){if(e.ok)return e.json();throw e})).then((function(e){console.log("data =",e),X(e.redirectUri),ae(e.denyUri),ce(e.scopes)})).catch((function(e){e.text().then((function(e){M(e)}))}))}}),r.a.createElement(U,{onSuccess:function(e){console.log("Login Success: accessToken:",e.accessToken),console.log("referrer: ",document.referrer);var t=document.referrer.split("/"),a=t[0]+"//"+t[2];console.log("host = ",a),fetch(a+"/facebook?accessToken="+e.accessToken,{redirect:"follow",credentials:"include"}).then((function(e){if(e.ok)return e.json();throw e})).then((function(e){console.log("data =",e),X(e.redirectUri),ae(e.denyUri),ce(e.scopes)})).catch((function(e){e.text().then((function(e){M(e)}))}))}}))))},R=a(33),I=a.n(R),A=a(50),F=Object(S.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));var B=function(e){var t=new URLSearchParams(e.location.search),a=F(),o=Object(n.useState)(""),c=Object(u.a)(o,2),i=c[0],l=c[1],s=Object(n.useState)(""),g=Object(u.a)(s,2),h=g[0],b=g[1],w=Object(n.useState)(""),O=Object(u.a)(w,2),j=O[0],y=O[1],S=Object(n.useState)(null==t.get("email")?"":t.get("email")),C=Object(u.a)(S,1)[0],k=Object(n.useState)(null==t.get("token")?"":t.get("token")),T=Object(u.a)(k,1)[0],N=function(){var e=Object(A.a)(I.a.mark((function e(t,a,n){var r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"POST",body:JSON.stringify(n),headers:a});case 3:if((r=e.sent).ok){e.next=6;break}throw r;case 6:return e.next=8,r.json();case 8:e.sent,y("The password has been reset."),e.next=19;break;case 12:return e.prev=12,e.t0=e.catch(0),e.next=16,e.t0.json();case 16:o=e.sent,console.log(o),y(o.description);case 19:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,a,n){return e.apply(this,arguments)}}();return r.a.createElement(_.a,{component:"main",maxWidth:"xs"},r.a.createElement(p.a,null),r.a.createElement("div",{className:a.paper},r.a.createElement(m.a,{className:a.avatar},r.a.createElement(v.a,null)),r.a.createElement(E.a,{component:"h1",variant:"h5"},"Reset Password"),r.a.createElement(x,{error:j}),r.a.createElement("form",{className:a.form,noValidate:!0,onSubmit:function(e){e.preventDefault();N("/portal/command",{"Content-Type":"application/json"},{host:"lightapi.net",service:"user",action:"resetPassword",version:"0.1.0",data:{email:C,token:T,newPassword:i,passwordConfirm:h}})}},r.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,disabled:!0,fullWidth:!0,id:"email",label:"Email",name:"email",value:C,autoComplete:"email",autoFocus:!0}),r.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"newPassword",value:i,label:"New Password",type:"password",id:"newPassword",autoComplete:"newPassword",onChange:function(e){l(e.target.value)}}),r.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"passwordConfirm",value:h,label:"Password Confirm",type:"password",id:"passwordConfirm",autoComplete:"passwordConfirm",onChange:function(e){b(e.target.value)}}),r.a.createElement(f.a,{name:"token",value:T,type:"hidden",id:"token"}),r.a.createElement(d.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:a.submit},"Submit"))))},q=Object(S.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));var V=function(){var e=q(),t=Object(n.useState)(""),a=Object(u.a)(t,2),o=a[0],c=a[1],i=Object(n.useState)(""),l=Object(u.a)(i,2),s=l[0],g=l[1],h=function(){var e=Object(A.a)(I.a.mark((function e(t,a,n){var r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"POST",body:JSON.stringify(n),headers:a});case 3:if((r=e.sent).ok){e.next=6;break}throw r;case 6:return e.next=8,r.json();case 8:e.sent,g("An Email has been sent."),e.next=19;break;case 12:return e.prev=12,e.t0=e.catch(0),e.next=16,e.t0.json();case 16:o=e.sent,console.log(o),g(o.description);case 19:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,a,n){return e.apply(this,arguments)}}();return r.a.createElement(_.a,{component:"main",maxWidth:"xs"},r.a.createElement(p.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement(m.a,{className:e.avatar},r.a.createElement(v.a,null)),r.a.createElement(E.a,{component:"h1",variant:"h5"},"Forget Password"),r.a.createElement(x,{error:s}),r.a.createElement("form",{className:e.form,noValidate:!0,onSubmit:function(e){e.preventDefault();h("/portal/command",{"Content-Type":"application/json"},{host:"lightapi.net",service:"user",action:"forgetPassword",version:"0.1.0",data:{email:o}})}},r.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email",name:"email",value:o,autoComplete:"email",autoFocus:!0,onChange:function(e){c(e.target.value)}}),r.a.createElement(d.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"Submit"))))};var H=function(){return r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,path:"/",component:L}),r.a.createElement(l.a,{exact:!0,path:"/reset",component:B}),r.a.createElement(l.a,{exact:!0,path:"/forget",component:V}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var K=a(67),J=a(133),G=Object(K.a)({typography:{useNextVariants:!0}});c.a.render(r.a.createElement(i.a,null,r.a.createElement(J.a,{theme:G},r.a.createElement(H,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[76,1,2]]]);
//# sourceMappingURL=main.0bdae82f.chunk.js.map
